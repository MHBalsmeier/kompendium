\subsubsection{Behandlung vertikal propagierender Wellen}
\label{sec:behandlung_vertikal_propagierender_wellen}

Vertikal propagierende Wellen werden aus Stabilitätsgründen anteilig implizit behandelt. Hierfür notiert man zunächst
%
\begin{align}
T' &\stackrel{\text{Glg. \eqref{eq:equation_of_state_id_gas_entropy}}}{=} \frac{\partial T}{\partial\rho}\rho' + \frac{\partial T}{\partial\newtilde{s}}\newtilde{s}' = \left(\frac{R_s}{c^{(v)}}\frac{T}{\rho} - \frac{\newtilde{s}}{c^{(v)}\rho^2}T\right)\rho' + \frac{T}{c^{(v)}\rho}\newtilde{s}' = \frac{T}{\rho c^{(v)}}\left(R_s - \frac{\newtilde{s}}{\rho}\right)\rho' + \frac{T}{c^{(v)}\rho}\newtilde{s}',\\
s' &\stackrel{s = \newtilde{s}/\rho}{=} \frac{\partial s}{\partial\rho}\rho' + \frac{\partial s}{\partial\newtilde{s}}\newtilde{s}' = -\frac{\newtilde{s}}{\rho^2}\rho' + \frac{1}{\rho}\newtilde{s}'.\\
\end{align}
%
Die Ableitungen kürzt man mit
%
\begin{align}
\alpha \coloneqq \frac{T}{\rho c^{(v)}}\left(R_s - \frac{\newtilde{s}}{\rho}\right),& \beta \coloneqq \frac{T}{c^{(v)}\rho},\\
\gamma \coloneqq -\frac{\newtilde{s}}{\rho^2},& \delta \coloneqq \frac{1}{\rho}
\end{align}
%
ab. Diese berechnet man in den Zellzentren mittels des alten Zustands (Zeitschritt $n$). Die vertikale Impulsgleichung notiert man in der Form
%
\begin{align}
w_{k - 1/2}^{(n + 1)} = w_{k - 1/2}^{(\text{expl.})} + \epsilon\Delta t\left(-c^{(p)}\frac{T^{(n + 1)}_{k - 1} - T^{(n + 1)}_{k}}{z_{k - 1} - z_{k}} + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\frac{s^{(n + 1)}_{k - 1} - s^{(n + 1)}_{k}}{z_{k - 1} - z_{k}}\right).\label{eq:wave_vertical_deriv_0}
\end{align}
%
Hierbei ist $\epsilon$ das implizite Gewicht, welches aufgrund von Abschn. \ref{sec:zeitentwicklung_der_inneren_energie} meist mit $\frac{c^{(v)}}{c^{(p)}}$ angesetzt wird. $\left(n + 1\right)^\star$ ist ein vorläufiger Wert für den neuen Zeitschritt. Für die impliziten Größen notiert man nun
%
\begin{align}
T^{(n + 1)}_k &= T^{(\text{expl.})}_k + T'_k = T^{(\text{expl.})}_k + \alpha_k\rho'_k + \beta_k\newtilde{s}'_k,\\
\newtilde{s}^{(n + 1)}_k &= \newtilde{s}^{(\text{expl.})}_k + \newtilde{s}'_k = \newtilde{s}^{(\text{expl.})}_k + \gamma_k\rho'_k + \delta_k\newtilde{s}'_k.
\end{align}
%
Die gestrichenen Größen sind die Abweichungen von den expliziten Komponenten, also
%
\begin{align}
\psi'_k \coloneqq \psi_k^{(n + 1)} - \psi_k^{(\text{expl.})}
\end{align}
%
für $\psi = \rho, \newtilde{s}.$ Hierfür gelten
%
\begin{align}
\rho_k' = -\Delta t\frac{M_{k - 1/2} - M_{k + 1/2}}{V_k},\\
\newtilde{s}_k' = -\Delta t\frac{\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}}{V_k}.
\end{align}
%
Hierbei definiert
%
\begin{align}
M_{k - 1/2} \coloneqq A_{k - 1/2}\frac{\newoverline{\rho_k^{(n)}}^{(k - 1/2)}w_{k - 1/2}^{(n + 1)} + \newoverline{\rho_k^{(n + 1)}}^{(k - 1/2)}w_{k - 1/2}^{(n)}}{2}\label{eq:def_ml}
\end{align}
%
für $2 \leq k \leq N_L$ die vertikale kovariante mit den Begrenzungsflächen $A_{k - 1/2}$ der Gitterboxen multiplizierte Massenflussdichte, dies ist der Unbekanntenvektor. Setzt man dies in Glg. \eqref{eq:wave_vertical_deriv_0} ein, erhält man
%
\begin{align}
w_{k - 1/2}^{(n + 1)} &= w_{k - 1/2}^{(\text{expl.})} + \epsilon\Delta t\left(-c^{(p)}\frac{T^{(\text{expl.})}_{k - 1} + T'_{k - 1} - T^{(\text{expl.})}_{k} - T'_k}{z_{k - 1} - z_{k}} + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\frac{s^{(\text{expl.})}_{k - 1} + s'_{k - 1} - s^{(\text{expl.})}_k - s'_k}{z_{k - 1} - z_k}\right)\nonumber\\
\Leftrightarrow w_{k - 1/2}^{(n + 1)} &= w_{k - 1/2}^{(\text{expl.})}\nonumber\\
&+ \epsilon\Delta t\cdot\Bigg(-c^{(p)}\frac{T^{(\text{expl.})}_{k - 1} + \alpha_{k - 1}\rho'_{k - 1} + \beta_{k - 1}\newtilde{s}'_{k - 1} - T^{(\text{expl.})}_{k} - \alpha_k\rho'_k - \beta_k\newtilde{s}'_k}{z_{k - 1} - z_{k}}\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\frac{s^{(\text{expl.})}_{k - 1} + \gamma_{k - 1}\rho'_{k - 1} + \delta_{k - 1}\newtilde{s}'_{k - 1} - s^{(\text{expl.})}_k - \gamma_k\rho'_k - \delta_k\newtilde{s}'_k}{z_{k - 1} - z_k}\Bigg)\nonumber\\
\Leftrightarrow w_{k - 1/2}^{(n + 1)} &= w_{k - 1/2}^{(\text{expl.})}\nonumber\\
&+ \epsilon\Delta t\Bigg(-c^{(p)}\frac{T^{(\text{expl.})}_{k - 1} - T^{(\text{expl.})}_{k}}{z_{k - 1} - z_{k}} + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\frac{s^{(\text{expl.})}_{k - 1} - s^{(\text{expl.})}_k}{z_{k - 1} - z_k}\Bigg)\nonumber\\
&+ \epsilon\Delta t\Bigg(-c^{(p)}\frac{\alpha_{k - 1}\rho'_{k - 1} + \beta_{k - 1}\newtilde{s}'_{k - 1} - \alpha_k\rho'_k - \beta_k\newtilde{s}'_k}{z_{k - 1} - z_{k}} + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\frac{\gamma_{k - 1}\rho'_{k - 1} + \delta_{k - 1}\newtilde{s}'_{k - 1} - \gamma_k\rho'_k - \delta_k\newtilde{s}'_k}{z_{k - 1} - z_k}\Bigg).
\end{align}
%
Die gestrichenen Größen enthalten den Unbekanntenvektor, daher bringt man sie auf die linke Seite:
%
\begin{align}
&\epsilon\Delta t\left(-c^{(p)}\frac{\alpha_{k - 1}\rho'_{k - 1} + \beta_{k - 1}\newtilde{s}'_{k - 1} - \alpha_k\rho'_k - \beta_k\newtilde{s}'_k}{z_{k - 1} - z_{k}} + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\frac{\gamma_{k - 1}\rho'_{k - 1} + \delta_{k - 1}\newtilde{s}'_{k - 1} - \gamma_k\rho'_k - \delta_k\newtilde{s}'_k}{z_{k - 1} - z_k}\right)\nonumber\\
&= w_{k - 1/2}^{(n + 1)} - w_{k - 1/2}^{(\text{expl.})} - \epsilon\Delta t\left(-c^{(p)}\frac{T^{(\text{expl.})}_{k - 1} - T^{(\text{expl.})}_{k}}{z_{k - 1} - z_{k}} + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\frac{s^{(\text{expl.})}_{k - 1} - s^{(\text{expl.})}_k}{z_{k - 1} - z_k}\right)\nonumber\\
&\Leftrightarrow-c^{(p)}\left(\alpha_{k - 1}\rho'_{k - 1} + \beta_{k - 1}\newtilde{s}'_{k - 1} - \alpha_k\rho'_k - \beta_k\newtilde{s}'_k\right) + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\left(\gamma_{k - 1}\rho'_{k - 1} + \delta_{k - 1}\newtilde{s}'_{k - 1} - \gamma_k\rho'_k - \delta_k\newtilde{s}'_k\right)\nonumber\\
&= \frac{\left(w_{k - 1/2}^{(n + 1)} - w_{k - 1/2}^{(\text{expl.})}\right)\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t} + c^{(p)}\left(T^{(\text{expl.})}_{k - 1} - T^{(\text{expl.})}_{k}\right) - \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\left(s^{(\text{expl.})}_{k - 1} - s^{(\text{expl.})}_k\right)\nonumber\\
&\Leftrightarrow-c^{(p)}\Bigg(-\alpha_{k - 1}\Delta t\frac{M_{k - 3/2} - M_{k - 1/2}}{V_{k - 1}} - \beta_{k - 1}\Delta t\frac{\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}}{V_{k - 1}}\Bigg)\nonumber\\
&-c^{(p)}\Bigg(\alpha_k\Delta t\frac{M_{k - 1/2} - M_{k + 1/2}}{V_k} + \beta_k\Delta t\frac{\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}}{V_k}\Bigg)\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg(-\gamma_{k - 1}\Delta t\frac{M_{k - 3/2} - M_{k - 1/2}}{V_{k - 1}} - \delta_{k - 1}\Delta t\frac{\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}}{V_{k - 1}}\Bigg)\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg(\gamma_k\Delta t\frac{M_{k - 1/2} - M_{k + 1/2}}{V_k} + \delta_k\Delta t\frac{\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}}{V_k}\Bigg)\nonumber\\
&= \frac{\left(w_{k - 1/2}^{(n + 1)} - w_{k - 1/2}^{(\text{expl.})}\right)\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t} + c^{(p)}\left(T^{(\text{expl.})}_{k - 1} - T^{(\text{expl.})}_{k}\right) - \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\left(s^{(\text{expl.})}_{k - 1} - s^{(\text{expl.})}_k\right)\nonumber\\
&\Leftrightarrow-c^{(p)}\Bigg(-\alpha_{k - 1}\frac{M_{k - 3/2} - M_{k - 1/2}}{V_{k - 1}} - \beta_{k - 1}\frac{\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}}{V_{k - 1}}\Bigg)\nonumber\\
&-c^{(p)}\Bigg(\alpha_k\frac{M_{k - 1/2} - M_{k + 1/2}}{V_k} + \beta_k\frac{\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}}{V_k}\Bigg)\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg(-\gamma_{k - 1}\frac{M_{k - 3/2} - M_{k - 1/2}}{V_{k - 1}} - \delta_{k - 1}\frac{\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}}{V_{k - 1}}\Bigg)\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg(\gamma_k\frac{M_{k - 1/2} - M_{k + 1/2}}{V_k} + \delta_k\frac{\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}}{V_k}\Bigg)\nonumber\\
&= \frac{\left(w_{k - 1/2}^{(n + 1)} - w_{k - 1/2}^{(\text{expl.})}\right)\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2} + \frac{c^{(p)}}{\Delta t}\left(T^{(\text{expl.})}_{k - 1} - T^{(\text{expl.})}_{k}\right) - \frac{\newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}}{\Delta t}\left(s^{(\text{expl.})}_{k - 1} - s^{(\text{expl.})}_k\right)
\end{align}
%
Nun nimmt man die Ersetzungen
%
\begin{align}
\alpha_k \to \frac{\alpha_k}{V_k},& \beta_k \to \frac{\beta_k}{V_k},\\
\gamma_k \to \frac{\gamma_k}{V_k},& \delta_k \to \frac{\delta_k}{V_k}
\end{align}
%
vor. Es folgt
%
\begin{align}
&-c^{(p)}\Bigg[-\alpha_{k - 1}\left(M_{k - 3/2} - M_{k - 1/2}\right) - \beta_{k - 1}\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}\right)\Bigg]\nonumber\\
&-c^{(p)}\Bigg[\alpha_k\left(M_{k - 1/2} - M_{k + 1/2}\right) + \beta_k\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}\right)\Bigg]\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg[-\gamma_{k - 1}\left(M_{k - 3/2} - M_{k - 1/2}\right) - \delta_{k - 1}\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}\right)\Bigg]\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg[\gamma_k\left(M_{k - 1/2} - M_{k + 1/2}\right) + \delta_k\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}\right)\Bigg]\nonumber\\
&=\frac{\left(w_{k - 1/2}^{(n + 1)} - w_{k - 1/2}^{(\text{expl.})}\right)\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2} + \frac{c^{(p)}}{\Delta t}\left(T^{(\text{expl.})}_{k - 1} - T^{(\text{expl.})}_{k}\right) - \frac{\newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}}{\Delta t}\left(s^{(\text{expl.})}_{k - 1} - s^{(\text{expl.})}_k\right)\nonumber\\
&\Leftrightarrow-c^{(p)}\Bigg[-\alpha_{k - 1}\left(M_{k - 3/2} - M_{k - 1/2}\right) - \beta_{k - 1}\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}\right)\Bigg]\nonumber\\
&-c^{(p)}\Bigg[\alpha_k\left(M_{k - 1/2} - M_{k + 1/2}\right) + \beta_k\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}\right)\Bigg]\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg[-\gamma_{k - 1}\left(M_{k - 3/2} - M_{k - 1/2}\right) - \delta_{k - 1}\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}\right)\Bigg]\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg[\gamma_k\left(M_{k - 1/2} - M_{k + 1/2}\right) + \delta_k\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}\right)\Bigg]\nonumber\\
&- \frac{\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2}w_{k - 1/2}^{(n + 1)}\nonumber\\
&= -\frac{w_{k - 1/2}^{(\text{expl.})}\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2} + \frac{c^{(p)}}{\Delta t}\left(T^{(\text{expl.})}_{k - 1} - T^{(\text{expl.})}_{k}\right) - \frac{\newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}}{\Delta t}\left(s^{(\text{expl.})}_{k - 1} - s^{(\text{expl.})}_k\right).\label{eq:vert_solver_pre_0}
\end{align}
%
Auch $w_{k - 1/2}^{(n + 1)}$ hängt von $M_l$ ab. Aus Glg. \eqref{eq:def_ml} folgt
%
\begin{align}
w^{(n + 1)}_{k - 1/2} &= \frac{\frac{2M_{k - 1/2}}{A_{k - 1/2}} - \newoverline{\rho_k^{(n + 1)}}^{(k - 1/2)}w^{(n)}_{k - 1/2}}{\newoverline{\rho_k^{(n)}}^{(k - 1/2)}}.\label{eq:w_from_ml}
\end{align}
%
Setzt man dies in Glg. \eqref{eq:vert_solver_pre_0} ein, erhält man
%
\begin{align}
&-c^{(p)}\Bigg[-\alpha_{k - 1}\left(M_{k - 3/2} - M_{k - 1/2}\right) - \beta_{k - 1}\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}\right)\Bigg]\nonumber\\
&-c^{(p)}\Bigg[\alpha_k\left(M_{k - 1/2} - M_{k + 1/2}\right) + \beta_k\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}\right)\Bigg]\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg[-\gamma_{k - 1}\left(M_{k - 3/2} - M_{k - 1/2}\right) - \delta_{k - 1}\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}\right)\Bigg]\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg[\gamma_k\left(M_{k - 1/2} - M_{k + 1/2}\right) + \delta_k\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}\right)\Bigg]\nonumber\\
&- \frac{\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2}\frac{\frac{2M_{k - 1/2}}{A_{k - 1/2}} - \newoverline{\rho_k^{(n + 1)}}^{(k - 1/2)}w^{(n)}_{k - 1/2}}{\newoverline{\rho_k^{(n)}}^{(k - 1/2)}}\nonumber\\
&= -\frac{w_{k - 1/2}^{(\text{expl.})}\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2} + \frac{c^{(p)}}{\Delta t}\left(T^{(\text{expl.})}_{k - 1} - T^{(\text{expl.})}_{k}\right) - \frac{\newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}}{\Delta t}\left(s^{(\text{expl.})}_{k - 1} - s^{(\text{expl.})}_k\right).
\end{align}
%
Für die Dichte $ \newoverline{\rho_k^{(n + 1)}}^{(k - 1/2)}$ gilt
%
\begin{align}
\newoverline{\rho_k^{(n + 1)}}^{(k - 1/2)} &= \frac{1}{2}\rho_{k - 1}^{(n + 1)} + \frac{1}{2}\rho_k^{(n + 1)}\nonumber\\
&= \frac{1}{2}\rho_{k - 1}^{(\text{expl.})} - \Delta t\frac{M_{k - 3/2} - M_{k - 1/2}}{2V_{k - 1}} + \frac{1}{2}\rho_k^{(\text{expl.})} - \Delta t\frac{M_{k - 1/2} - M_{k + 1/2}}{2V_k}.
\end{align}
%
Hieraus folgt
%
\begin{align}
&-c^{(p)}\Bigg[-\alpha_{k - 1}\left(M_{k - 3/2} - M_{k - 1/2}\right) - \beta_{k - 1}\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}\right)\Bigg]\nonumber\\
&-c^{(p)}\Bigg[\alpha_k\left(M_{k - 1/2} - M_{k + 1/2}\right) + \beta_k\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}\right)\Bigg]\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg[-\gamma_{k - 1}\left(M_{k - 3/2} - M_{k - 1/2}\right) - \delta_{k - 1}\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}M_{k - 3/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2}\right)\Bigg]\nonumber\\
&+ \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\Bigg[\gamma_k\left(M_{k - 1/2} - M_{k + 1/2}\right) + \delta_k\left(\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}\right)\Bigg]\nonumber\\
&- \frac{\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2}\frac{\frac{2M_{k - 1/2}}{A_{k - 1/2}} - w^{(n)}_{k - 1/2}\left(-\Delta t\frac{M_{k - 3/2} - M_{k - 1/2}}{2V_{k - 1}} - \Delta t\frac{M_{k - 1/2} - M_{k + 1/2}}{2V_k}\right)}{\newoverline{\rho_k^{(n)}}^{(k - 1/2)}}\nonumber\\
&= -\frac{\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2}\frac{\newoverline{\rho_k^{(\text{expl.})}}^{(k - 1/2)}w^{(n)}_{k - 1/2}}{\newoverline{\rho_k^{(n)}}^{(k - 1/2)}} -\frac{w_{k - 1/2}^{(\text{expl.})}\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2} + \frac{c^{(p)}}{\Delta t}\left(T^{(\text{expl.})}_{k - 1} - T^{(\text{expl.})}_{k}\right) - \frac{\newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}}{\Delta t}\left(s^{(\text{expl.})}_{k - 1} - s^{(\text{expl.})}_k\right).
\end{align}
%
Dies ist die zu lösende Gleichung. Diese ist formal von der Form
%
\begin{align}
c_{k - 3/2}M_{k - 3/2} + d_{k - 1/2}M_{k - 1/2} + e_{k + 1/2}M_{k + 1/2} = r_{k - 1/2}.
\end{align}
%
Für die Koeffizienten gilt
%
\begin{align}
c_{k - 3/2} &= c^{(p)}\alpha_{k - 1} + c^{(p)}\beta_{k - 1}\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)} - \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\gamma_{k - 1} - \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\delta_{k - 1}\newoverline{s_k^{(n + 1)^\star}}^{(k - 3/2)}\nonumber\\
&- \frac{\left(z_{k - 1} - z_k\right)w^{(n)}_{k - 1/2}}{2\epsilon\Delta tV_{k - 1}\newoverline{\rho_k^{(n)}}^{(k - 1/2)}},\\
d_{k - 1/2} &= -c^{(p)}\alpha_{k - 1} - c^{(p)}\left(\beta_{k - 1} + \beta_k\right)\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)} - c^{(p)}\alpha_k + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\gamma_{k - 1} + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\delta_{k - 1}\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}\nonumber\\
&- \frac{\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2\newoverline{\rho_k^{(n)}}^{(k - 1/2)}}\frac{2}{A_{k - 1/2}} + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\gamma_k + \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\delta_k\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}\nonumber\\
& + \frac{\left(z_{k - 1} - z_k\right)w^{(n)}_{k - 1/2}}{\epsilon\Delta t\newoverline{\rho_k^{(n)}}^{(k - 1/2)}}\left(\frac{1}{2V_{k - 1}} - \frac{1}{2V_k}\right),\\
e_{k + 1/2} &= c^{(p)}\alpha_k + c^{(p)}\beta_k\newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)} - \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\gamma_k - \newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}\delta_k\newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}  + \frac{\left(z_{k - 1} - z_k\right)w^{(n)}_{k - 1/2}}{\epsilon\Delta t\newoverline{\rho_k^{(n)}}^{(k - 1/2)}}\frac{1}{2V_k},\\
r_{k - 1/2} &= -\frac{\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2}\frac{\newoverline{\rho_k^{(\text{expl.})}}^{(k - 1/2)}w^{(n)}_{k - 1/2}}{\newoverline{\rho_k^{(n)}}^{(k - 1/2)}} -\frac{w_{k - 1/2}^{(\text{expl.})}\left(z_{k - 1} - z_k\right)}{\epsilon\Delta t^2}\nonumber\\
&+ \frac{c^{(p)}}{\Delta t}\left(T^{(\text{expl.})}_{k - 1} - T^{(\text{expl.})}_{k}\right) - \frac{\newoverline{T_k^{(n + 1)^\star}}^{(k - 1/2)}}{\Delta t}\left(s^{(\text{expl.})}_{k - 1} - s^{(\text{expl.})}_k\right).
\end{align}
%
Aus dem Ergebnis für $M_{k - 1/2}$ lassen sich die anderen Unbekannten wie folgt bestimmen:
%
\begin{align}
\rho^{(n + 1)}_k &= \rho^{(\text{expl.})}_k - \Delta t\frac{M_{k - 1/2} - M_{k + 1/2}}{V_k},\\
\newtilde{s}^{(n + 1)}_k &= \newtilde{s}^{(\text{expl.})}_k - \Delta t\frac{\newoverline{s_k^{(n + 1)^\star}}^{(k - 1/2)}M_{k - 1/2} - \newoverline{s_k^{(n + 1)^\star}}^{(k + 1/2)}M_{k + 1/2}}{V_k},\\
w^{(n + 1)}_{k - 1/2} &\stackrel{\text{Glg. \eqref{eq:w_from_ml}}}{=} \frac{\frac{2M_{k - 1/2}}{A_{k - 1/2}} - \newoverline{\rho_k^{(n + 1)}}^{(k - 1/2)}w^{(n)}_{k - 1/2}}{\newoverline{\rho_k^{(n)}}^{(k - 1/2)}},\\
T^{(n + 1)}_{k} &= T^{(\text{expl.})}_{k} + \alpha_k\left(\rho^{(n + 1)}_k  - \rho^{(\text{expl.})}_k\right) + \beta_k\left(\newtilde{s}^{(n + 1)}_k - \newtilde{s}^{(\text{expl.})}_k\right).
\end{align}

